<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>NBA GM 單機版（更新的 v0.4）</title>
<style>
body{font-family:Arial;background:#f5f5f5;padding:20px}
h1{margin-bottom:5px}
.version{color:red;font-weight:bold;margin-bottom:15px}
button{margin:4px;padding:6px 12px;cursor:pointer}
table{border-collapse:collapse;background:#fff;margin-top:10px}
th,td{border:1px solid #ccc;padding:6px 10px;text-align:center}
#layout{display:flex;gap:20px}
#panel{background:#fff;padding:10px;min-width:220px}
.selected{background:#dff0ff}
.trade{color:orange;font-weight:bold}
</style>
</head>

<body>
<h1>NBA GM 單機版</h1>
<div class="version">（更新的｜v0.4 球員養成）</div>

<h2>Step 1：選擇球隊</h2>
<select id="teamSelect"></select>
<button onclick="selectTeam()">開始 GM 生涯</button>

<div id="game" style="display:none">
  <h2 id="teamTitle"></h2>

  <div id="layout">
    <!-- 球員列表 -->
    <div>
      <table id="roster">
        <thead>
          <tr>
            <th>球員</th>
            <th>位置</th>
            <th>OVR</th>
            <th>年齡</th>
            <th>薪資</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <!-- 操作面板 -->
    <div id="panel">
      <h3>球員操作</h3>
      <div id="playerInfo">請選擇球員</div>
      <button onclick="trainPlayer()">訓練（隨機）</button><br>
      <button onclick="toggleTrade()">標記為交易籌碼</button>
    </div>
  </div>

  <div id="log" style="margin-top:15px;background:#fff;padding:10px">
    GM 準備就緒
  </div>
</div>

<script>
console.log("NBA GM v0.4 LOADED");

// ===== NBA 資料 =====
const teams = {
 Warriors:[
  {name:"Stephen Curry",pos:"PG",ovr:97,age:36,salary:51,trade:false},
  {name:"Klay Thompson",pos:"SG",ovr:88,age:34,salary:43,trade:false},
  {name:"Draymond Green",pos:"PF",ovr:86,age:34,salary:22,trade:false},
  {name:"Jonathan Kuminga",pos:"SF",ovr:81,age:22,salary:6,trade:false}
 ],
 Lakers:[
  {name:"LeBron James",pos:"SF",ovr:96,age:40,salary:48,trade:false},
  {name:"Anthony Davis",pos:"PF",ovr:94,age:31,salary:40,trade:false},
  {name:"Austin Reaves",pos:"SG",ovr:84,age:26,salary:12,trade:false}
 ],
 Celtics:[
  {name:"Jayson Tatum",pos:"SF",ovr:95,age:26,salary:32,trade:false},
  {name:"Jaylen Brown",pos:"SG",ovr:92,age:27,salary:52,trade:false},
  {name:"Jrue Holiday",pos:"PG",ovr:88,age:34,salary:36,trade:false}
 ],
 Nuggets:[
  {name:"Nikola Jokic",pos:"C",ovr:98,age:29,salary:47,trade:false},
  {name:"Jamal Murray",pos:"PG",ovr:90,age:27,salary:36,trade:false}
 ],
 Bucks:[
  {name:"Giannis Antetokounmpo",pos:"PF",ovr:97,age:29,salary:49,trade:false},
  {name:"Damian Lillard",pos:"PG",ovr:94,age:34,salary:45,trade:false}
 ]
};

let playerTeam=null;
let selectedIndex=null;

// 初始化選單
const sel=document.getElementById("teamSelect");
Object.keys(teams).forEach(t=>{
 let o=document.createElement("option");
 o.value=t;o.textContent=t;
 sel.appendChild(o);
});

// ===== 功能 =====
function selectTeam(){
 playerTeam=sel.value;
 document.getElementById("game").style.display="block";
 document.getElementById("teamTitle").textContent="你是 "+playerTeam+" 的 GM";
 renderRoster();
 log("請點選一名球員開始管理");
}

function renderRoster(){
 const tb=document.querySelector("#roster tbody");
 tb.innerHTML="";
 teams[playerTeam].forEach((p,i)=>{
  const tr=document.createElement("tr");
  if(i===selectedIndex) tr.classList.add("selected");
  tr.innerHTML=`
   <td>${p.name}${p.trade?" <span class='trade'>TRADE</span>":""}</td>
   <td>${p.pos}</td>
   <td>${p.ovr}</td>
   <td>${p.age}</td>
   <td>$${p.salary}M</td>
  `;
  tr.onclick=()=>selectPlayer(i);
  tb.appendChild(tr);
 });
}

function selectPlayer(i){
 selectedIndex=i;
 const p=teams[playerTeam][i];
 document.getElementById("playerInfo").innerHTML=`
  <b>${p.name}</b><br>
  OVR：${p.ovr}<br>
  年齡：${p.age}<br>
  薪資：$${p.salary}M
 `;
 renderRoster();
}

function trainPlayer(){
 if(selectedIndex===null){alert("請先選球員");return;}
 const p=teams[playerTeam][selectedIndex];
 let gain=0;
 if(p.age<=24) gain=Math.random()<0.7?1:0;
 else if(p.age<=30) gain=Math.random()<0.4?1:0;
 else gain=Math.random()<0.2?0:-1;
 p.ovr=Math.max(60,p.ovr+gain);
 log(`${p.name} 訓練結果：${gain>=0?"+":""}${gain}`);
 renderRoster();
}

function toggleTrade(){
 if(selectedIndex===null){alert("請先選球員");return;}
 const p=teams[playerTeam][selectedIndex];
 p.trade=!p.trade;
 log(`${p.name} ${p.trade?"已":"取消"}列入交易名單`);
 renderRoster();
}

function log(t){
 document.getElementById("log").textContent=t;
}
</script>
</body>
</html>
